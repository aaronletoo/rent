<!DOCTYPE html>
<html>
<head>
    <title></title>
    <link href="lib/ligerUI/skins/Aqua/css/ligerui-all.css" rel="stylesheet" type="text/css" />
    <script src="lib/ligerUI/js/plugins/ligerForm.js" type="text/javascript"></script>
    <script src="lib/ligerUI/js/plugins/ligerDateEditor.js" type="text/javascript"></script>
    <script src="lib/ligerUI/js/plugins/ligerComboBox.js" type="text/javascript"></script>
    <script src="lib/ligerUI/js/plugins/ligerCheckBox.js" type="text/javascript"></script>
    <script src="lib/ligerUI/js/plugins/ligerButton.js" type="text/javascript"></script>
    <script src="lib/ligerUI/js/plugins/ligerDialog.js" type="text/javascript"></script>
    <script src="lib/ligerUI/js/plugins/ligerRadio.js" type="text/javascript"></script>
    <script src="lib/ligerUI/js/plugins/ligerSpinner.js" type="text/javascript"></script>
    <script src="lib/ligerUI/js/plugins/ligerTextBox.js" type="text/javascript"></script>
    <script src="lib/ligerUI/js/plugins/ligerMenu.js" type="text/javascript"></script>
    <script src="lib/ligerUI/js/plugins/ligerMenuBar.js" type="text/javascript"></script>
   <!--引入Jslider-->
    <link rel="stylesheet" href="jslider/css/jslider.css" type="text/css">
    <link rel="stylesheet" href="jslider/css/jslider.plastic.css" type="text/css">
    <script type="text/javascript" src="jslider/js/jshashtable-2.1_src.js"></script>
    <script type="text/javascript" src="jslider/js/jquery.numberformatter-1.2.3.js"></script>
    <script type="text/javascript" src="jslider/js/tmpl.js"></script>
    <script type="text/javascript" src="jslider/js/jquery.dependClass-0.1.js"></script>
    <script type="text/javascript" src="jslider/js/draggable-0.1.js"></script>
    <script type="text/javascript" src="jslider/js/jquery.slider.js"></script>

    <script type="text/javascript">
        /*
        导出报表
         */
        var menu1 = { width: 100, items:
                [
                    {
                    text: '导出', children:
                            [
                                { text: 'excel',id:'excel', click: itemclick },
                                { text: 'word', id: 'word', click: itemclick },
                                { text: 'pdf', id: 'pdf', click: itemclick }
                            ]
                    }/*,
                    {
                        text:'上传',children:
                            [
                                {text:'上传模板',id:'upload',click:itemclick}
                            ]
                    }*/
                ]
        };
        $(function ()
        {
            //菜单条
            $("#topmenu").ligerMenuBar({items: [
                { text: '文件', menu:menu1}
            ]
            });
        });
        function exportReportCallback(data1){
            if(data1.code==200){
                $.ligerDialog.success('操作成功')
            }
        }
        function itemclick(item)
        {
            if(item.id)
            {
                switch(item.id)
                {
                    case 'upload':
                    {
                    }
                    default:
                            {
                                var type=item.text;
                                var province = $("#province").val()==''?' ':$("#province").val();
                                var city = $("#city").val()==''?' ':$("#city").val();
                                var area = $("#area").val()==''?' ': $("#area").val();
                                var unitaddress = $("#unitaddress").val()==''?' ':$("#unitaddress").val();
                                var riskvalueareaslider=$("#riskvalueareaslider").val();
                                var values=[];
                                values= riskvalueareaslider.split(";");
                                var startValue = values[0];
                                var endValue=values[1];
                                var equipmentvariety=$("#equipmentvariety").val()==''?' ':$("#equipmentvariety").val();
                                var minweight=$("#minweight").val()==''?'0':$("#minweight").val();
                                var maxweight=$("#maxweight").val()==''?'1000':$("#maxweight").val();
                                var data=type+","+province+","+city+","+area+","+unitaddress+","+startValue+","+endValue+","+equipmentvariety+","+minweight+","+maxweight;
                                location.href="rs/report/exportCraneReport/data="+encodeURI(data);
                            }
                }
            }
        }
       /*
          发送post请求，获得省数据
       */
        $.post($.URL.address.getProvinceList,null,listCallback,"json");
        /*
         所有联动效果基于第一次请求，不嵌套的话第二次会得不到值
         */
        function listCallback(data){
            if(data.code==200){
                /*
                 取出省地址数据
                 */
                var provinceList=[];
                provinceList.push({id:0,text:"请选择"}) ;
                for(var i=0;i<data.data.length;i++)
                {
                    var j={};
                    j["text"]=data.data[i].province;
                    j["id"]=i+1;
                    provinceList.push(j);
                }
                   $("#province").ligerComboBox({
                    data: provinceList,
                    isShowCheckBox:true,isMultiSelect:false,
                    valueFieldID: 'provinceSelect' ,
                    /*
                     选择省后的联动效果
                     */
                    onSelected:function(a,b)
                    {
                        if($("#province").val()!="请选择"&&$("#province").val()!="")
                        {
                        $.post($.URL.address.getCityByProvince,{"province":b},getcitylistCallback,"json");
                        }
                        function getcitylistCallback(citydata){
                            if(citydata.code==200){
                                var cityList=[];
                                cityList .push({id:0,text:"请选择"});
                                for(var i=0;i<citydata.data.length;i++)
                                {
                                    var j={};
                                    j["text"]=citydata.data[i].city;
                                    j["id"]=i+1;
                                    cityList.push(j);
                                }
                                $("#city").ligerComboBox({
                                    data:cityList,
                                    isShowCheckBox:true,isMultiSelect:false,
                                    /*
                                     选择市后的联动效果
                                     */
                                    onSelected:function(m,n)
                                    {
                                        if($("#city").val()!="请选择"&&$("#city").val()!="")
                                        {
                                            $.post($.URL.address.getAreaByProvinceAndCity,{"province":$("#province").val(),"city":$("#city").val()},getarealistCallback,"json");
                                        }

                                        function getarealistCallback(areadata){
                                            if(areadata.code==200){

                                                var areaList=[];
                                                areaList .push({id:0,text:"请选择"}) ;
                                                for(var i=0;i<areadata.data.length;i++)
                                                {
                                                    var j={};
                                                    j["text"]=areadata.data[i].area;
                                                    j["id"]=i+1;
                                                    areaList.push(j);
                                                }
                                                $("#area").ligerComboBox({ isShowCheckBox:true,isMultiSelect:false,
                                                    data:areaList, valueFieldID: 'areaSelect',
                                                    /*
                                                     选择区域后的联动效果
                                                     */
                                                    onSelected:function(m,n)
                                                    {
                                                        var testdata={};
                                                        if($("#area").val()!="请选择"&&$("#area").val()!="")
                                                        {
                                                            testdata.province=$("#province").val();
                                                            testdata.city=$("#city").val();
                                                            testdata.area=$("#area").val();
                                                            $.post($.URL.craneinspectreport.getUnitaddressByArea,testdata,getunitCallback,"json");
                                                        }

                                                        function getunitCallback(unitdata){
                                                            if(unitdata.code==200){
                                                                var unitList=[];
                                                                unitList .push({id:0,text:"请选择"}) ;
                                                                for(var i=0;i<unitdata.data.length;i++)
                                                                {
                                                                    var j={};
                                                                    j["text"]=unitdata.data[i].unitAddress;
                                                                    j["id"]=i+1;
                                                                    unitList.push(j);
                                                                }
                                                                $("#unitaddress").ligerComboBox({ isShowCheckBox:true,isMultiSelect:false,
                                                                    data:unitList, valueFieldID: 'unitaddressSelect' })
                                                            }
                                                        }
                                                    }
                                                })
                                            }
                                        }
                                    }
                                })
                            }
                        }
                    }
                })
            }
        }
       /*
         定义起重机类型数据源，
       */
        $.post($.URL.craneinspectreport.getEquipmentVarietyList,null,getEquipmentVarietyListCallback,"json");
        function getEquipmentVarietyListCallback(equdata)
        {
            if(equdata.code==200)
            {
                var equVarietyList=[];
                equVarietyList.push({id:0,text:"请选择"}) ;
                for(i=0;i<equdata.data.length;i++)
                {
                    var  j={};
                    j["text"]=equdata.data[i].equipmentVariety;
                    j["id"]=i+1;
                    equVarietyList.push(j);
                }
                $("#equipmentvariety").ligerComboBox({ isShowCheckBox:true,isMultiSelect:false,
                    data: equVarietyList
                    , valueFieldID: 'equipmentvarietySelect' })
            }
        }

        /*
        获得风险值列表
         */
        /*
        $.post($.URL.riskColor.getRiskValueList,null,getRiskValueListCallBack,"json");
      function  getRiskValueListCallBack(riskvaluedata)
         {
            if(riskvaluedata.code==200)
            {
                var riskValueList=[];
                riskValueList.push({id:0,text:"请选择"})  ;
                for(i=0;i<riskvaluedata.data.length;i++)
                {
                    var j={};
                    j["text"]=riskvaluedata.data[i].riskValue;
                    j["id"] =i+1;
                    riskValueList.push(j);
                }
                $("#minRiskValue").ligerComboBox({
                    data: riskValueList ,isShowCheckBox:true,isMultiSelect:false ,
                    valueFieldID: 'minRiskValueSelect'
                })
                $("#maxRiskValue").ligerComboBox({
                    data: riskValueList ,isShowCheckBox:true,isMultiSelect:false ,
                    valueFieldID: 'maxRiskValueSelect'
                })
            }
        }*/

       /*
            load页面的显示报表全部数据
       */

       function loadReportCallback(data1){
           if(data1.code==200){
               $.ligerDialog.success('操作成功')
           }
       }
        $("#reportresult").load("rs/report/showChinaChart",null,loadReportCallback,"json");
       /*
               提交页面的查询报表数据
        */
        $("#submitBtn").click(function(){
            $("#reportresult").html();
            if($("#province").val()!="请选择"&&$("#province").val()!="")
            {
                if($("#city").val()!="请选择"&&$("#city").val()!="")
                    {
                        var data = {};
                        data.province = $("#province").val();
                        data.city = $("#city").val();
                        data.area = $("#area").val();
                        data.unitaddress = $("#unitaddress").val();
                        data.riskvalueareaslider= $("#riskvalueareaslider").val();
                        data.equipmentvariety=$("#equipmentvariety").val();
                        if($("#minweight").val()=="")
                        {
                            data.minweight=0 ;
                        }
                        else
                        {
                        data.minweight=$("#minweight").val() ;
                        }
                        if($("#maxweight").val()=="")
                        {
                            data.maxweight=1000;
                        }
                        else
                        {
                            data.maxweight=$("#maxweight").val() ;
                        }
                        $.post($.URL.report.showCraneReport,data,loadReportCallback,"json");
                        //location.href="/rs/report/showCraneReport"
                        $("#reportresult").load("rs/report/showCraneReport",data,loadReportCallback,"json") ;
                    }
            else
                {
                    $("#reportresult").html();
                    $("#reportresult").load("rs/report/showProvinceRiskValue",{"province":$("#province").val()},loadReportCallback,"json") ;
                }
            }

            else
            {
                $("#reportresult").load("rs/report/showChinaChart",null,loadReportCallback,"json");
            }
        });
        <!--滑杆脚本-->
        $("#riskvalueareaslider").slider({ from: 1, to: 9, scale: [1, '|', 3, '|', '5', '|', 7, '|', 9], limits: false, step: 1, dimension: '', skin: "plastic",
            callback: function( value ){
                var values= [];
                values=value.split(";");
                alert("滑竿"+value);
            }
        });

    </script>
    <style type="text/css">
        .l-table-edit {}
        .l-table-edit-td{ padding:2px;}
        .l-table-edit-tdcmb{ padding:2px;}
        .l-button-submit,{width:80px; float:left; margin-left:10px; padding-bottom:2px;}
        .layout-slider{width: 500px}
        .weightArea{width: 80px}
        #riskvalueareaslider{
            width: 500px;
        }
       /* #accordion1{
            overflow: scroll;
            height: 95%;
            width: 100%;
            margin-bottom: 30px;
        }*/
    </style>

</head>
<body>
<div id="topmenu" class="l-menubar"/>
<div>
<form name="form1" method="post" action="" id="form1">
    <table cellpadding="0" cellspacing="0" class="l-table-edit" >
        <tr>
            <td align="right" class="l-table-edit-td">省:</td>
            <td align="left" class="l-table-edit-tdcmb">
                <input type="text" readonly="true" id="province">
            </td>
            <td align="right" class="l-table-edit-td">市:</td>
            <td align="left" class="l-table-edit-tdcmb">
                <input type="text" readonly="true" id="city">
            </td>
            <td align="right" class="l-table-edit-td">区域:</td>
            <td align="left" class="l-table-edit-tdcmb">
                <input type="text" readonly="true" id="area">
            </td>
            <td align="right" class="l-table-edit-td">使用单位:</td>
            <td align="left" class="l-table-edit-td">
                <input type="text" readonly="true" id="unitaddress">
            </td>
            <td align="right" class="l-table-edit-td">起重机类型:</td>
            <td align="left" class="l-table-edit-td">
                <input type="text" readonly="true" id="equipmentvariety">
            </td>
        </tr>
    </table>
    <table cellpadding="0" cellspacing="0" class="l-table-edit" >
         <!--   <td align="right" class="l-table-edit-td">风险值区间:</td>
            <td align="left" class="l-table-edit-td">
                <input type="text" readonly="true" id="minRiskValue">
            </td>
            <td align="left" class="l-table-edit-td">
            <input type="text" readonly="true" id="maxRiskValue">
            </td>
           <td align="right" class="l-table-edit-td">起重机吨位:</td>
            <td align="left" class="l-table-edit-td">
              <input type="text" readonly="true" id="mindunwei">
            </td>
            <td align="left" class="l-table-edit-td">
              <input type="text" readonly="true" id="maxdunwei">
            </td>
            <td>
                <input type="button" value="提交" id="submitBtn" class="l-button l-button-submit" />
            </td>-->
              <td align="right" id="riskValueArea" class="l-table-edit-td">风险值区间:</td>
              <td align="left" class="layout-slider">
                  <input id="riskvalueareaslider" type="slider" name="riskValueArea" value="1;9" />
              </td>
            <td align="right" id="weightArea" class="l-table-edit-td">起重区间:</td>
            <td align="left" class="weightArea">
                <input id="minweight" type="text"   />
            </td>
            <td align="right"  >吨----></td>
            <td align="left" class="weightArea">
                <input id="maxweight" type="text"   />
            </td>
            <td align="right" >吨</td>
            <td>
              <input type="button" value="提交" id="submitBtn" class="l-button l-button-submit" />
            </td>

        </tr>
    </table>
    <br />
</form>
    </div>
<div id="accordion1" class="l-accordion-panel">
    <div id="reportresult" style="margin-bottom: 50px"></div>
</div>

    <!--  数据统计代码 -->



</body>
</html>